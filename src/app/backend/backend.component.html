<div class="container-fluid">
    <h2>Backends</h2>
    <div class="row mt-3 mb-3 row-size">
        <div class="d-flex  align-items-end add-backend">
          <div class="col-sm-3">
            <label for="url" class="form-label">Host</label>
            <input type="text" class="form-control" id="host" [(ngModel)]="mainHost">
          </div>
            <div class="col-sm-3">
                <label for="url" class="form-label">URL &nbsp; <svg
                    [matTooltip]=url_tooltip xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                    fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
                    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16" />
                    <path
                        d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0" />
                </svg></label>
                
                <input type="text" class="form-control" id="url" [(ngModel)]="mainUrl">
                
                
              </div>
              <div class="col-sm-3">
                <label for="method" class="form-label">Method</label>
                <select class="form-select" aria-label="Default select example" id="method" [(ngModel)]="mainMethod">
                  <option selected>Select Method</option>
                  <option value="GET">GET</option>
                  <option value="POST">POST</option>
                  <option value="PUT">PUT</option>
                  <option value="PATCH">PATCH</option>
                  <option value="DELETE">DELETE</option>
                </select>
              </div>
              <div class="col-sm-3">
                <!-- <button class="btn btn-primary" style="border-radius: 50%;"[disabled]="!mainUrl || !mainMethod || !mainHost" (click)="addPanel()"><i class="bi bi-plus-circle-fill"></i></button> -->
                <button class="btn btn-primary" style="border-radius: 50%;" [disabled]="!mainUrl || !mainMethod || !mainHost" (click)="addPanel()"><svg
                  xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                  class="bi bi-plus-lg" viewBox="0 0 16 16">
                  <path fill-rule="evenodd"
                      d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2" />
              </svg></button>
                <!-- <button mat-raised-button color="primary"[disabled]="!mainUrl || !mainMethod || !mainHost" (click)="addPanel()">Add Backend</button> -->
              </div>
            
        </div>
      </div>
    <mat-accordion class="mt-3">
      <mat-expansion-panel *ngFor="let item of items; let i = index">
        <mat-expansion-panel-header>
          <mat-panel-title>
            <!-- {{ item.isNew ? :  }} -->
              @if(item.isNew){
                <span class="main-method d-flex justify-content-center align-items-center">{{getFormGroup(i).value.method}}</span> &nbsp;{{getFormGroup(i).value.endpointUrl}}
              }@else{
                <span class="main-method d-flex justify-content-center align-items-center">{{getFormGroup(i).value.method}}</span> &nbsp;{{getFormGroup(i).value.endpointUrl}}
              }
          </mat-panel-title>
          <mat-panel-description>
            <!-- ID: {{ item.id || 'Not Saved Yet' }} -->
          </mat-panel-description>
        </mat-expansion-panel-header>
  
        <!-- Dynamic Form -->
        <!-- <form [formGroup]="getFormGroup(i)">
          <div class="mb-3">
            <label for="name{{ i }}" class="form-label">Name</label>
            <input type="text" id="name{{ i }}" formControlName="name" class="form-control" />
          </div>
          <div class="mb-3">
            <label for="id{{ i }}" class="form-label">ID</label>
            <input type="text" id="id{{ i }}" formControlName="id" class="form-control" readonly />
          </div>
        </form> -->
        <form [formGroup]="getFormGroup(i)">
            <mat-accordion multi>
                <mat-expansion-panel>
                    <mat-expansion-panel-header>
                        <mat-panel-title>
                          <!-- {{ item.isNew ? 'New Panel' : 'Existing Panel' }} - {{ item.name || 'Unnamed' }} -->
                            Request
                        </mat-panel-title>
                        <mat-panel-description>
                          <!-- ID: {{ item.id || 'Not Saved Yet' }} -->
                        </mat-panel-description>
                      </mat-expansion-panel-header>
                    <div class="section-1">
                        <div class="row">
                          <!-- <form [formGroup]="formGroupUpstreamRequest">
                  
                      </form> -->
                          <div class="col-sm-12">
                            <h3>The request options define how KrakenD interacts with the upstream service.</h3>
                            <h2>Connection</h2>
                            <p>Connect to host(s)</p>
                            <div class="hostname-div">
                              <!-- <input type="text" class="form-control" formControlName="host" /> -->
                              <div class="input-group mb-3">
                                <input type="text" id="host" class="form-control" formControlName="host">
                                <button class="btn btn-primary" type="button" id="button-addonHost"
                                    (click)="addParameterRequest(i)"><i class="bi bi-plus-lg"></i></button>
                            </div>
                              <!-- <button mat-raised-button class="addhost-btn mt-1" (click)="addParameterRequest(i)">Add host</button> -->
                            </div>
                            <div class="mt-3 d-flex">
                  
                              <button *ngFor="let host of hostArray[i]; let j = index" class="parameter-item">
                                {{ host }}<mat-icon (click)="removeParameterRequest(i,j)"
                                  class="d-flex align-items-center justify-content-end">close</mat-icon>
                              </button>
                            </div>
                          </div>
                          <div class="row mt-3">
                            <div class="col-sm-12 col-md-3">
                              <div class="mb-3">
                                <label for="method" class="form-label">Method</label>
                                <select class="form-select" aria-label="Default select example" id="method" formControlName="method">
                                  <option selected>Select Method</option>
                                  <option value="GET">GET</option>
                                  <option value="POST">POST</option>
                                  <option value="PUT">PUT</option>
                                  <option value="PATCH">PATCH</option>
                                  <option value="DELETE">DELETE</option>
                                </select>
                              </div>
                            </div>
                            <div class="col-sm-12 col-md-3">
                              <div class="mb-3">
                                <label for="url" class="form-label">URL &nbsp; <svg
                                    [matTooltip]=url_tooltip xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                    fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
                                    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16" />
                                    <path
                                        d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0" />
                                </svg></label>
                                <input type="text" class="form-control" id="url" formControlName="endpointUrl">
                                
                              </div>
                            </div>
                            <div class="col-sm-12 col-md-3">
                              <div class="mb-3">
                                <label for="decodeas" class="form-label">Decode as &nbsp; <svg
                                    [matTooltip]=decodeas_tooltip xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                    fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
                                    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16" />
                                    <path
                                        d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0" />
                                </svg></label>
                                <select class="form-select" aria-label="Default select example" id="decodeas" formControlName="decodeAs">
                                  <option selected>Select Format</option>
                                  <option value="json">JSON</option>
                                  <option value="xml">XML</option>
                                  <option value="rss">RSS</option>
                                  <option value="string">String</option>
                                  <option value="No-Op">No-Op(Leave as is)</option>
                                </select>
                              </div>
                            </div>
                            <div class="col-sm-12 col-md-3">
                              <div class="mb-3">
                                <label class="form-label">Resolution</label>
                                <div class="form-check">
                                  <input class="form-check-input" type="checkbox" value="" id="flexCheckChecked"
                                    formControlName="sanitization">
                                  <label class="form-check-label" for="flexCheckChecked">
                                    Disable Sanitization &nbsp; <svg
                                    [matTooltip]=disSanitization_tooltip xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                    fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
                                    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16" />
                                    <path
                                        d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0" />
                                </svg>
                                  </label>
                                </div>
                              </div>
                            </div>
                          </div>
                  
                        </div>
                        <hr />
                        <div class="row">
                          <div class="col-sm-12 heading-with-toggle d-flex align-items-center gap-2">
                            <div>
                                <!-- <input class="form-check-input" formControlName="isStaticServerActive" type="checkbox" value="" id="isStaticServerActive">
                              <label class="form-check-label" for="isStaticServerActive">
                                Static Server
                              </label> -->
                              <h3>Static Server</h3>
                            </div>
                            <div>
                              <mat-slide-toggle color="blue" formControlName="isStaticServerActive"></mat-slide-toggle>
                            </div>
                          </div>
                          <div>
                            <p>It works similarly to a regular web server; it loads content from the disk and presents it to the users for a given path.
                            </p>
                            @if (getFormGroup(i).value.isStaticServerActive) {
                            <div class="row">
                              <div class="col-sm-12 col-md-6">
                                <div class="mb-3">
                                  <label for="staticUrl" class="form-label">URL &nbsp; <svg
                                    [matTooltip]=staticUrl_tooltip xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                    fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
                                    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16" />
                                    <path
                                        d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0" />
                                </svg></label>
                                  <input type="text" class="form-control" id="staticUrl" formControlName="staticUrl"
                                    placeholder="/etc/krakend/assets">
                                  
                                </div>
                              </div>
                              <div class="col-sm-12 col-md-6">
                                <div class="mb-3">
                                  <!-- <label class="form-label">Resolution</label> -->
                                  <div class="form-check mt-4">
                                    <input class="form-check-input" type="checkbox" value="" id="directory"
                                      formControlName="directory_Listing">
                                    <label class="form-check-label" for="directory">
                                      Directory Listing  &nbsp; <svg
                                      [matTooltip]=directory_tooltip xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                      fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
                                      <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16" />
                                      <path
                                          d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0" />
                                  </svg>
                                    </label>
                                  </div>
                                  
                  
                                </div>
                              </div>
                            </div>
                            }
                          </div>
                  
                        </div>
                        <hr>
                        <div class="row">
                          <div class="col-sm-12 heading-with-toggle d-flex align-items-center gap-2">
                            <div>
                              <h3>Body Manipulation and Generation</h3>
                            </div>
                            <div>
                              <mat-slide-toggle color="blue" formControlName="isBodymanipulationActive"></mat-slide-toggle>
                            </div>
                          </div>
                  
                          @if(getFormGroup(i).value.isBodymanipulationActive){
                          <div class="row">
                            <div class="col-md-5 col-sm-12 form-check form-check-inline">
                              <input class="form-check-input" type="radio" formControlName="bodyEditor" id="inlineRadio1"
                                value="bodyeditor">
                              <label class="form-check-label" for="inlineRadio1">Use the inline body editor</label>
                            </div>
                  
                            <div class="col-md-5 col-sm-12 form-check form-check-inline">
                              <input class="form-check-input" type="radio" formControlName="bodyEditor" id="inlineRadio2"
                                value="external">
                              <label class="form-check-label" for="inlineRadio2">An external file</label>
                            </div>
                          </div>
                  
                          <div class="col-sm-12">
                            <label for="exampleFormControlTextarea1" class="form-label">Body Editor &nbsp; <svg
                                [matTooltip]=bodyEditor_tooltip xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
                                <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16" />
                                <path
                                    d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0" />
                            </svg></label>
                            <textarea class="form-control fingerprint" id="exampleFormControlTextarea1" rows="3"
                              formControlName="template"></textarea>
                            <!-- <div class="form-text">The response body you will return to the end-user. You can introduce the variables
                              .resp_headers.xxx, .resp_headers.xxx (with no-op), .resp_status.xxx (with no-op), .resp_body.xxx,
                              .req_params.Xxx, .req_headers.xxx, .req_querystring.xxx, .req_path</div> -->
                          </div>
                  
                          <div class="row mt-2">
                            <div class="col-sm-6">
                              <label for="conType" class="form-label">Content Type &nbsp; <svg
                                [matTooltip]=contentType_tooltip xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
                                <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16" />
                                <path
                                    d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0" />
                            </svg></label>
                              <input type="text" id="conType" class="form-control" formControlName="contentType"
                                placeholder="application/json">
                              
                            </div>
                            <div class="col-sm-12 col-md-6">
                                <label for="path" class="form-label">Path  &nbsp; <svg
                                    [matTooltip]=path_tooltip xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                    fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
                                    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16" />
                                    <path
                                        d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0" />
                                </svg></label>
                                <input type="text" id="path" class="form-control" formControlName="path" placeholder="./file.tmpl.xml">
                                
                              </div>
                            
                  
                          </div>
                  
                          <div class="col-sm-12 col-md-6 mt-2">
                            <!-- <mat-checkbox class="example-margin" formControlName="debug">Enable Debug</mat-checkbox> -->
                             <div class="form-check">
                              <input class="form-check-input" formControlName="debug" type="checkbox" value="" id="debug">
                              <label class="form-check-label" for="debug">
                                Debug  &nbsp; <svg
                                [matTooltip]=debug_tooltip xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
                                <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16" />
                                <path
                                    d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0" />
                            </svg>
                              </label>
                             </div>
                            
                            <!-- <input type="checkbox" formControlName="debug" class="form-control"/> -->
                            
                          </div>
                          }@else {
                          <p>The body generator modifier allows you to craft the body you send to a backend through templates, and enables
                            injecting other values from the user request such as the original body, headers, querystrings or URL
                            parameters.</p>
                          }
                  
                        </div>
                        <hr>
                        <div class="row">
                          <div class="col-sm-12 heading-with-toggle d-flex align-items-center gap-2">
                            <div>
                              <h3>Martian (Req/Resp static manipulation)</h3>
                            </div>
                            <div>
                              <mat-slide-toggle color="blue" formControlName="isMartianActive"></mat-slide-toggle>
                            </div>
                          </div>
                  
                          @if(getFormGroup(i).value.isMartianActive){
                          <h3>Martian DSL &nbsp; <svg
                            [matTooltip]=martian_tooltip xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                            fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
                            <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16" />
                            <path
                                d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0" />
                        </svg></h3>
                          <textarea class="static-text-area form-control" formControlName="martianDslTextarea"></textarea>
                          
                          }@else {
                          <p>Transform requests and responses through a simple DSL definition. The input must be a JSON object with
                            Martian format</p>
                          }
                          <div class="col-sm-12 d-flex justify-content-end">
                            <!-- <button mat-raised-button color="primary" (click)="saveForm()">
                          Save
                        </button> -->
                          </div>
                        </div>
                    </div>
                </mat-expansion-panel>
                <mat-expansion-panel>
                    <mat-expansion-panel-header>
                        <mat-panel-title>
                          <!-- {{ item.isNew ? 'New Panel' : 'Existing Panel' }} - {{ item.name || 'Unnamed' }} -->
                            Response Manipulation
                        </mat-panel-title>
                        <mat-panel-description>
                          <!-- ID: {{ item.id || 'Not Saved Yet' }} -->
                        </mat-panel-description>
                      </mat-expansion-panel-header>
                      <div class="section-2">
                        <div class="row">
                            <h3>Basic Manipulation</h3>
                      
                            <div class="col-sm-12">
                              <h3>You can modify the structure of the data before you return it to the endpoint where is aggregated with other
                                endpoints.</h3>
                            </div>
                            <div class="row mb-3">
                              <div class="col-sm-6">
                                <label for="rootObject" class="form-label">Root Object  &nbsp; <svg
                                    [matTooltip]=rootObj_tooltip xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                    fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
                                    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16" />
                                    <path
                                        d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0" />
                                </svg></label>
                                <input type="text" id="rootObject" class="form-control" formControlName="rootObject"
                                  placeholder="Leave blank to use all the reponse">
                                
                              </div>
                              <div class="col-sm-6 menu-card">
                                <label class="form-label">is it a collection?</label>
                                <div class="form-check">
                                  <input class="form-check-input" type="checkbox" value="" id="flexCheckChecked"
                                    formControlName="isCollection">
                                  <label class="form-check-label" for="flexCheckChecked">
                                    Response is a array. &nbsp; <svg
                                    [matTooltip]=collection_tooltip xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                    fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
                                    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16" />
                                    <path
                                        d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0" />
                                </svg>
                                  </label>
                                </div>
                                
                              </div>
                            </div>
                            @if (!getFormGroup(i).value.isCollection) {
                            <div class="row mb-3">
                      
                              <div class="col-sm-12 mt-3">
                                <h4>Backend Upstreams for v1/basal-forect/&#123;id_forest&#125;</h4>
                              </div>
                              <div class="col-sm-6">
                                <ul class="menu-list d-flex">
                                  @for(item of itemsRes;track item){
                                  <li class="nav-item" (click)="selectItem(item)" [class.selected]="item === selectedItem">
                                    <a class="nav-link active" class="nav-link-inserted">{{item.name}}</a>
                                  </li>
                                  }
                                </ul>
                              </div>
                      
                              <div class="col-sm-12">
                                @if (selectedItem.name ==='Deny') {
                                <p>Attributes that you will NOT pick from the response:  &nbsp; <svg
                                    [matTooltip]=allowDeny_tooltip xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                    fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
                                    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16" />
                                    <path
                                        d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0" />
                                </svg></p>
                                <div class="col-sm-6">
                                  <div class="mb-3">
                                    <div class="d-flex gap-2">
                                      <input type="text" class="form-control" formControlName="deniedAttr" id="audience"
                                        aria-describedby="audience" placeholder="attribute_name">
                                      <button type="button" class="btn btn-outline-primary" (click)="addParameter(i,'deniedAttr')">Add</button>
                                    </div>
                                    
                                  </div>
                                  <div class="mt-3 d-flex">
                                    <button *ngFor="let attr of deniedAttributesArr; let j = index" class="parameter-item">
                                      {{ attr }}<mat-icon (click)="removeParameter(i,j,'deniedAttr')"
                                        class="d-flex align-items-center justify-content-end">close</mat-icon>
                                    </button>
                                  </div>
                                </div>
                                }@else if (selectedItem.name==='Allow') {
                                <p>Attributes that you will pick from the response  &nbsp; <svg
                                    [matTooltip]=allowDeny_tooltip xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                    fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
                                    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16" />
                                    <path
                                        d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0" />
                                </svg></p>
                                <div class="col-sm-6">
                                  <div class="mb-3">
                                    <div class="d-flex gap-2">
                                      <input type="text" class="form-control" formControlName="allowedAttr" id="audience"
                                        aria-describedby="audience" placeholder="attribute_name">
                                      <button type="button" class="btn btn-outline-primary" (click)="addParameter(i,'allowedAttr')">Add</button>
                                    </div>
                                    
                                  </div>
                                  <div class="mt-3 d-flex">
                                    <button *ngFor="let attr of allowedAttributesArr; let j = index" class="parameter-item">
                                      {{ attr }}<mat-icon (click)="removeParameter(i,j,'allowedAttr')"
                                        class="d-flex align-items-center justify-content-end">close</mat-icon>
                                    </button>
                                  </div>
                                </div>
                                }
                      
                              </div>
                            </div>
                            }
                            <div class="row mb-3">
                              <div class="col-sm-6">
                                <label for="rootObject" class="form-label">Wrapping Group &nbsp; <svg
                                    [matTooltip]=wrappingGroup_tooltip xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                    fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
                                    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16" />
                                    <path
                                        d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0" />
                                </svg></label>
                                <input type="text" id="rootObject" class="form-control" formControlName="wrappingGroup"
                                  placeholder="my-group">
                                
                              </div>
                            </div>
                            <div class="row mb-3">
                              <div class="col-sm-12">
                                <h4>Renaming <i class="bi bi-info-circle" [matTooltip]=renaming_tooltip></i></h4>
                              </div>
                              <div class="col-sm-12 col-md-4">
                                <label for="rootObject" class="form-label">Original Object</label>
                                <input type="text" class="form-control" formControlName="originalObj" id="originalObject"
                                  aria-describedby="audience" placeholder="id_imported_user">
                              </div>
                              <div class="col-sm-12 col-md-4">
                                <label for="rootObject" class="form-label">Renamed Object</label>
                                
                                  <div class="input-group mb-3">
                                    <input type="text" class="form-control" formControlName="renamedObj" id="renamedObject"
                                  aria-describedby="audience" placeholder="id">
                                    <button class="btn btn-primary" type="button" id="button-addonRenameObj"
                                    (click)="addParameter(i,'renaming')"><svg xmlns="http://www.w3.org/2000/svg" width="16"
                                            height="16" fill="currentColor" class="bi bi-plus-lg" viewBox="0 0 16 16">
                                            <path fill-rule="evenodd"
                                                d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2" />
                                        </svg></button>
                                </div>
                              </div>
                              <!-- <div class="col-sm-12 col-md-4 d-flex justify-items-end">
                                <button type="button" class="btn btn-outline-primary" (click)="addParameter(i,'renaming')">Add</button>
                              </div> -->
                      
                      
                              <div class=" col-sm-12 mt-3 d-flex">
                                <button *ngFor="let attr of objectMaps[i] | keyvalue" class="parameter-item">
                                  {{ attr.key }} -> {{attr.value}}<mat-icon (click)="removeParameter(i,attr.key ,'renaming')"
                                    class="d-flex align-items-center justify-content-end">close</mat-icon>
                                </button>
                              </div>
                            </div>
                          </div>
                          <hr>
                          <!-- Caching section -->
                          <div class="row gap-3">
                            <div class="col-sm-12 heading-with-toggle d-flex align-items-center gap-2">
                              <div>
                                <h3>Caching</h3>
                              </div>
                              <div>
                                <mat-slide-toggle color="blue" #tokenValidation formControlName="isCachingActive"></mat-slide-toggle>
                              </div>
                            </div>
                      
                            @if (getFormGroup(i).value.isCachingActive) {
                            <div class="col-sm-12">
                              <p>All responses from the backend are stored in-memory honoring the time specified in the Cache-Control header
                                sent by the server</p>
                            </div>
                            <div class="col-sm-12">
                              <p> Memory consumption and CPU usage will increase proportionally to the amount and size of cached entries.</p>
                            </div>
                            <div class="col-sm-12">
                              <mat-checkbox class="example-margin" formControlName="isSharedCacheActive">Shared Cache &nbsp; <svg
                                [matTooltip]=sharedCache_tooltip xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
                                <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16" />
                                <path
                                    d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0" />
                            </svg></mat-checkbox>
                             
                            </div>
                            }
                          </div>
                          <hr>
                          <div class="row gap-3">
                            <div class="row heading-with-toggle d-flex align-items-center gap-2">
                              <div>
                                <h3>Advance Response Manipulation (JMESPath)</h3>
                              </div>
                              <div>
                                <mat-slide-toggle color="blue" formControlName="AdvResManipulationActive"></mat-slide-toggle>
                              </div>
                            </div>
                      
                            @if (getFormGroup(i).value.AdvResManipulationActive) {
                            <div class="col-sm-12">
                              <p>Manipulate the response dataset after the aggregation layer using a JSON Query language.</p>
                            </div>
                      
                            <div class="col-sm-6">
                              <label for="exp" class="form-label">Expression &nbsp; <svg
                                [matTooltip]=expression_tooltip xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
                                <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16" />
                                <path
                                    d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0" />
                            </svg></label>
                              <input type="text" id="exp" class="form-control" formControlName="expression"
                                placeholder="people[?age > `20`].[name, age]">
                              <div id="expHelpBlock" class="form-text">
                                JMESpath query to execute on returned results of /
                              </div>
                            </div>
                      
                      
                            <div class="col-sm-12 exp-main">
                              <h4>Example of how JMESpath works</h4>
                            </div>
                            <div class="row">
                              <div class="col-sm-6 exp-main">
                                <h4>Server Response</h4>
                                <div class="exp-info">
                                  <h4>
                                    <pre>{{ jsonData | json }}</pre>
                                  </h4>
                                </div>
                              </div>
                              <div class="col-sm-6 exp-main d-flex flex-column gap-2">
                                <div>
                                  <h4>Expression</h4>
                                  <div class="exp-info">
                                    <h4>
                                      <pre>students[?age > `18` ].name</pre>
                                    </h4>
                                  </div>
                                </div>
                                <div>
                                  <h4>Returned Response</h4>
                                  <div class="exp-info">
                                    <h4>
                                      <pre>["Bill", "Jessica"]</pre>
                                    </h4>
                                  </div>
                                </div>
                              </div>
                            </div>
                            }@else {
                            <div class="col-sm-12">
                              <p>Manipulate the response dataset after the aggregation layer using a JSON Query language.</p>
                            </div>
                            }
                          </div>
                          <hr>
                          <div class="row gap-3">
                            <div class="col-sm-12 heading-with-toggle d-flex align-items-center gap-2">
                              <div>
                                <h3>Response Manipulation with Go templates</h3>
                              </div>
                              <div>
                                <mat-slide-toggle color="blue" formControlName="resManiWithGoTemplActive"></mat-slide-toggle>
                              </div>
                            </div>
                      
                            @if (getFormGroup(i).value.resManiWithGoTemplActive) {
                            <div class="row">
                              <div class="col-md-5 col-sm-12 form-check form-check-inline">
                                <input class="form-check-input" type="radio" formControlName="bodyEditor" id="inlineRadio1"
                                  value="bodyeditor">
                                <label class="form-check-label" for="inlineRadio1">Use the inline body editor</label>
                              </div>
                      
                              <div class="col-md-5 col-sm-12 form-check form-check-inline">
                                <input class="form-check-input" type="radio" formControlName="bodyEditor" id="inlineRadio2" value="external">
                                <label class="form-check-label" for="inlineRadio2">An external file</label>
                              </div>
                            </div>
                      
                            <div class="col-sm-8">
                              <label for="exampleFormControlTextarea1" class="form-label">Body Editor &nbsp; <svg
                                [matTooltip]=bodyEditorRes_tooltip xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
                                <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16" />
                                <path
                                    d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0" />
                            </svg></label>
                              <textarea class="form-control fingerprint" id="exampleFormControlTextarea1" rows="3"
                                formControlName="template"></textarea>
                              </div>
                      
                            <div class="row">
                              <div class="col-sm-6">
                                <label for="conType" class="form-label">Content Type &nbsp; <svg
                                    [matTooltip]=contentTypeRes_tooltip xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                    fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
                                    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16" />
                                    <path
                                        d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0" />
                                </svg></label>
                                <input type="text" id="conType" class="form-control" formControlName="contentType"
                                  placeholder="application/json">
                                
                              </div>
                              <div class="col-sm-6">
                                <mat-checkbox class="example-margin" formControlName="debug">Enable Debug &nbsp; <svg
                                    [matTooltip]=debudRes_tooltip xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                    fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
                                    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16" />
                                    <path
                                        d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0" />
                                </svg></mat-checkbox>
                                
                              </div>
                      
                            </div>
                      
                            <div class="col-sm-6">
                              <label for="path" class="form-label">Path &nbsp; <svg
                                [matTooltip]=pathRes_tooltip xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
                                <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16" />
                                <path
                                    d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0" />
                            </svg></label>
                              <input type="text" id="path" class="form-control" formControlName="path" placeholder="./file.tmpl.xml">
                              
                            </div>
                      
                      
                            }@else {
                            <p>The response body generator lets you write a whole new payload using a template that has access to all the
                              response data. In addition to the payload from the backend, you can incorporate other information such as
                              headers, status codes, query strings, or URL parameters.</p>
                            }
                          </div>
                          <hr>
                          <div class="row gap-3">
                      
                            <div class="col-sm-12 heading-with-toggle d-flex align-items-center gap-2">
                              <div>
                                <h3>Regexp Content Replacer</h3>
                              </div>
                              <div>
                                <mat-slide-toggle color="blue" formControlName="regexConReplacerActive"></mat-slide-toggle>
                              </div>
                            </div>
                            @if (getFormGroup(i).value.regexConReplacerActive) {
                      
                            <div class="row align-items-center">
                              <div class="col-sm-4">
                                <label for="findkey" class="form-label">Enter Key Name for Content Replacer <i class="bi bi-info-circle" [matTooltip]=contentReplacer_tooltip></i></label>
                                
                                  <div class="input-group mb-3">
                                    <input type="text" id="findkey" class="form-control" formControlName="contentReplacerKey"
                                  placeholder="e.g., 'hem'">
                                    <button class="btn btn-primary" type="button" id="button-addonConRep"
                                    (click)="createContentReplacerKey(i)">Create Key</button>
                                </div>
                              </div>
                              <!-- <div class="col-sm-4">
                                <button type="button" class="btn btn-dark" (click)="createContentReplacerKey(i)">Create Key</button>
                              </div> -->
                            </div>
                      
                            <!-- Step 2: Display find, replace, and regexp controls for the created key -->
                            <div *ngIf="isKeyCreated">
                      
                              <div [formGroupName]="'contentReplacer'">
                                <div class="row align-items-center gap-2" [formGroupName]="getFormGroup(i).value.contentReplacerKey">
                      
                      
                                  <div class="col-sm-3">
                                    <label for="findkey" class="form-label">Key to replace <i class="bi bi-info-circle"[matTooltip]=keyToReplace_tooltip></i></label>
                                    <input type="text" id="findkey" class="form-control" formControlName="find">
                                    
                                  </div>
                      
                                  <div class="col-sm-3">
                                    <label for="replace" class="form-label">Replace by <i class="bi bi-info-circle" [matTooltip]=replaceBy_tooltip></i></label>
                                    <input type="text" id="replace" class="form-control" formControlName="replace">
                                    
                                  </div>
                      
                                  <div class="col-sm-3">
                                    <mat-checkbox class="example-margin" formControlName="regexp">Regexp mode <i class="bi bi-info-circle" [matTooltip]=regexMode_tooltip></i></mat-checkbox>
                                    
                                  </div>
                      
                                  <div class="col-sm-12">
                                    <button type="button" class="btn btn-primary" (click)="resetFields(i)">Delete</button>
                                  </div>
                      
                                </div>
                              </div>
                            </div>
                            }@else {
                            <p>The content replacer plugin allows you to modify the response of your services by doing literal replacements or
                              more sophisticated replacements with regular expressions.</p>
                            }
                          </div>
                          <hr>
                          <div class="row gap-1">
                            <div class="col-sm-12">
                              <h4>Flatmap Manipulation</h4>
                            </div>
                            <div class="col-sm-12">
                              <p>Responses using arrays need a special treatment. Add here your desired manipulations</p>
                            </div>
                      
                            <div class="row gap-3">
                              <div class="col-sm-3">
                                <label for="opType" class="form-label">Operation Type</label>
                                <select class="form-select" aria-label="Default select example" formControlName="operationType" id="opType">
                                  <option selected>Open this select menu</option>
                                  <option value="move">Move</option>
                                  <option value="del">Delete </option>
                                  <option value="append">Append </option>
                                </select>
                              </div>
                              <div class="col-sm-3">
                                <label for="originlObj" class="form-label">Original Object</label>
                                <input type="text" id="originlObj" class="form-control" aria-describedby="passwordHelpBlock"
                                  formControlName="flatmapOriginalObj" placeholder="object.*.uninteresting">
                              </div>
                              @if (!(getFormGroup(i).value.operationType === 'delete')) {
                              <div class="col-sm-3">
                                <label for="targetObj" class="form-label">Target Object</label>
                                <input type="text" id="targetObj" class="form-control" aria-describedby="passwordHelpBlock"
                                  formControlName="flatmapTargetObj" placeholder="object.*.new_element">
                              </div>
                              }
                      
                            </div>
                      
                            <div class=" col-sm-12 mt-3 d-flex">
                              <button *ngFor="let attr of faltMapArr[i] ; let j = index" class="parameter-item">
                                {{ attr?.type }} -> [ "{{ attr?.args[0] !== null && attr?.args[0] !== undefined ? attr.args[0] : '' }}"
                                @if (attr?.args[1] !== null && attr?.args[1]!== undefined) {
                                ,
                                "{{ attr?.args[1] !== null && attr?.args[1] !== undefined ? attr.args[1] : '' }}"
                                }
                                ]<mat-icon (click)="removeParameter(i,j,'flatMap')"
                                  class="d-flex align-items-center justify-content-end">close</mat-icon>
                              </button>
                      
                            </div>
                            <div class="col-sm-12">
                              <button type="button" class="btn btn-dark" (click)="addParameter(i,'flatMap')">Add Operation</button>
                            </div>
                      
                          </div>
                          <div class="row gap-3">
                      
                            <div class="col-sm-12 heading-with-toggle d-flex align-items-center gap-2">
                              <div>
                                <h3>Martian (Req/resp static manipulation)</h3>
                              </div>
                              <div>
                                <mat-slide-toggle color="blue" formControlName="martianActive"></mat-slide-toggle>
                              </div>
                            </div>
                            @if (getFormGroup(i).value.martianActive) {
                            <div class="col-sm-8">
                              <label for="exampleFormControlTextarea1" class="form-label">Body Editor <i class="bi bi-info-circle" [matTooltip]=bodyEditorMartian_tooltip></i></label>
                              <textarea class="form-control fingerprint" id="exampleFormControlTextarea1" rows="3"
                                formControlName="martian"></textarea>
                              </div>
                            }@else {
                            <p>Transform requests and responses through a simple DSL definition. The input must be a JSON object with Martian
                              format</p>
                            }
                          </div>
                          <!-- <div class="row mb-3">
                            {{getFormGroup(i).value | json}}
                          </div> -->
                       
                    </div>
                </mat-expansion-panel>
                <mat-expansion-panel>
                    <mat-expansion-panel-header>
                        <mat-panel-title>
                          <!-- {{ item.isNew ? 'New Panel' : 'Existing Panel' }} - {{ item.name || 'Unnamed' }} -->
                            Throttling
                        </mat-panel-title>
                        <mat-panel-description>
                          <!-- ID: {{ item.id || 'Not Saved Yet' }} -->
                        </mat-panel-description>
                      </mat-expansion-panel-header>
                      <div class="section-3">
                        <div class="row">
                            <h3>Control and limit the interaction between KrakenD and your service.</h3>
                            <div class="col-sm-12 heading-with-toggle d-flex align-items-center gap-2">
                              <div>
                                <h3>Circuit Breaker</h3>
                              </div>
                              <div>
                                <mat-slide-toggle color="blue" formControlName="isCircuitBreakerActive"></mat-slide-toggle>
                              </div>
                            </div>
                    
                            @if(!getFormGroup(i).value.isCircuitBreakerActive){
                            <p>Watches the state of the connections to your backend and when it sees more than the configured number of
                              consecutive failures within an interval it stops temporarily all the interaction with the backend.
                            </p>
                            }@else{
                            <div class="row">
                              <div class="col-sm-12 col-md-6">
                                <div class="mb-3">
                                  <label for="name" class="form-label">Name <i class="bi bi-info-circle" [matTooltip]=circuitName_tooltip></i></label>
                                  <input type="text" class="form-control" id="name" formControlName="circuitBreakerName">
                                  
                                </div>
                              </div>
                              <div class="col-sm-12 col-md-6">
                                <div class="mb-3">
                                  <label for="maxerr" class="form-label">Maximum Errors <i class="bi bi-info-circle" [matTooltip]=maxErrors_tooltip></i></label>
                                  <input type="number" class="form-control" id="maxerr" formControlName="maxError"
                                    [class.is-invalid]="getFormGroup(i).get('maxError')?.invalid">
                                </div>
                              </div>
                              <div class="col-sm-12 col-md-6">
                                <div class="mb-3">
                                  <label for="inteval" class="form-label">Interval <i class="bi bi-info-circle" [matTooltip]=interval_tooltip></i></label>
                                  <input type="number" class="form-control" id="interval" formControlName="interval"
                                    [class.is-invalid]="getFormGroup(i).get('interval')?.invalid">
                                </div>
                              </div>
                              <div class="col-sm-12 col-md-6">
                                <div class="mb-3">
                                  <label for="timeout" class="form-label">Timeout <i class="bi bi-info-circle" [matTooltip]=timeout_tooltip></i></label>
                                  <input type="number" class="form-control" id="timeout" formControlName="timeout"
                                    [class.is-invalid]="getFormGroup(i).get('timeout')?.invalid">
                                </div>
                              </div>
                              <div class="col-sm-12 col-md-6">
                                <div class="mb-3">
                                  <!-- <label class="form-label">Resolution</label> -->
                                  <div class="form-check mt-4">
                                    <input class="form-check-input" type="checkbox" value="" id="logState"
                                      formControlName="logStatusChange">
                                    <label class="form-check-label" for="logState">
                                      Log state changes <i class="bi bi-info-circle" [matTooltip]=logStatusChange_tooltip></i>
                                    </label>
                                  </div>
                                 
                    
                                </div>
                              </div>
                            </div>
                            }
                          </div>
                          <hr>
                          <div class="row">
                            <div class="col-sm-12 heading-with-toggle d-flex align-items-center gap-2">
                              <div>
                                <h3>Proxy Rate limit</h3>
                              </div>
                              <div>
                                <mat-slide-toggle color="blue" formControlName="isProxyRateLimitActive"></mat-slide-toggle>
                              </div>
                            </div>
                            @if(!getFormGroup(i).value.isProxyRateLimitActive){
                            <p>Limits the number of requests KrakenD can do to your backend service /</p>
                            }@else{
                            <div class="row">
                              <div class="col-sm-12 col-md-6">
                                <div class="mb-3">
                                  <label for="maxRateLimit" class="form-label">MaxRateLimit <i class="bi bi-info-circle" [matTooltip]=maxRateLimit_tooltip></i></label>
                                  <input type="number" class="form-control" id="maxRateLimit" formControlName="maxRateLimit"
                                    [class.is-invalid]="getFormGroup(i).get('maxRateLimit')?.invalid">
                                  
                                </div>
                              </div>
                              <div class="col-sm-12 col-md-6">
                                <div class="mb-3">
                                  <label for="every" class="form-label">Every <i class="bi bi-info-circle" [matTooltip]=everyThrot_tooltip></i></label>
                                  <input type="text" class="form-control" id="every" formControlName="every"
                                    [class.is-invalid]="getFormGroup(i).get('every')?.invalid && getFormGroup(i).get('every')?.touched">
                                  <div class="invalid-feedback"
                                    *ngIf="getFormGroup(i).get('every')?.errors?.['pattern'] && getFormGroup(i).get('every')?.touched">
                                    The amount of time you want to assign followed by its unit (e.g.: `2s`, `200ms`). <br> Valid time units
                                    are: ns, us, (or s), ms, s, m, h.
                                  </div>
                                  
                                </div>
                              </div>
                              <div class="col-sm-12 col-md-6">
                                <div class="mb-3">
                                  <label for="capacity" class="form-label">Capacity(Burst size) <i class="bi bi-info-circle" [matTooltip]=capacityThrot_tooltip></i></label>
                                  <input type="number" class="form-control" id="capacity" formControlName="capacity"
                                    [class.is-invalid]="getFormGroup(i).get('capacity')?.invalid">
                                  
                                </div>
                              </div>
                            </div>
                            }
                            <div class="col-sm-12 d-flex justify-content-end">
                              <!-- <button mat-raised-button color="primary" (click)="saveForm()">Save</button> -->
                            </div>
                          </div>
                      </div>
                </mat-expansion-panel>
                <mat-expansion-panel>
                    <mat-expansion-panel-header>
                        <mat-panel-title>
                          <!-- {{ item.isNew ? 'New Panel' : 'Existing Panel' }} - {{ item.name || 'Unnamed' }} -->
                            Authentication
                        </mat-panel-title>
                        <mat-panel-description>
                          <!-- ID: {{ item.id || 'Not Saved Yet' }} -->
                        </mat-panel-description>
                      </mat-expansion-panel-header>
                      <div class="section-4">
                        <div class="row">
                            <div class="col-sm-12">
                              <h3>Set authentication requirements between KrakenD and your services. If you'd like to pass JWT tokens to the
                                backend as well, add the Authorization header in the endpoint's parameter forwarding.</h3>
                    
                            </div>
                            <div class="col-sm-12 heading-with-toggle d-flex align-items-center gap-2">
                              <div>
                                <h3>Auth: Client Credentials</h3>
                              </div>
                              <div>
                                <mat-slide-toggle color="blue" formControlName="isAuthActive"></mat-slide-toggle>
                              </div>
                            </div>
                            @if(!getFormGroup(i).value.isAuthActive){
                            <p>Enable a 2-legged OAuth2 flow, making the gateway request a token to an authorization server before reaching
                              the backend's protected resources. The token refreshes when needed.</p>
                            }@else{
                            <div class="row">
                              <div class="col-sm-12 col-md-6">
                                <div class="mb-3">
                                  <label for="clientId" class="form-label">CLIENT ID <i class="bi bi-info-circle" [matTooltip]=clientId_tooltip></i></label>
                                  <input type="text" class="form-control" id="clientId" formControlName="clientId">
                                  
                                </div>
                              </div>
                              <div class="col-sm-12 col-md-6">
                                <div class="mb-3">
                                  <label for="clientSecret" class="form-label">CLIENT SECRET <i class="bi bi-info-circle" [matTooltip]=clientSecret_tooltip></i></label>
                                  <input type="text" class="form-control" id="clientSecret" formControlName="clientSecret">
                                </div>
                              </div>
                              <div class="col-sm-12 col-md-6">
                                <div class="mb-3">
                                  <label for="tokenUrl" class="form-label">Token URL <i class="bi bi-info-circle" [matTooltip]=tokenUrl_tooltip></i></label>
                                  <input type="text" class="form-control" id="tokenUrl" formControlName="tokenUrl">
                                  
                                </div>
                              </div>
                              <div class="col-sm-12 col-md-6">
                                <div class="mb-3">
                                  <label for="scopes" class="form-label">Scopes <i class="bi bi-info-circle" [matTooltip]=scopes_tooltip></i></label>
                                  <input type="text" class="form-control" id="scopes" formControlName="scopes">
                                </div>
                              </div>
                              <div class="row mb-3">
                                <div class="col-sm-12">
                                  <h4>Additional endpoint parameters <i class="bi bi-info-circle" [matTooltip]=objEndpointParameter_tooltip></i></h4>
                                </div>
                                <div class="col-sm-12 col-md-4">
                                  <!-- <label for="rootObject" class="form-label">Original Object</label> -->
                                  <input type="text" class="form-control" formControlName="endpointKey" id="endpointKey"
                                    aria-describedby="audience" placeholder="name">
                                </div>
                    
                                <div class="col-sm-12 col-md-4">
                                  <!-- <label for="rootObject" class="form-label">Renamed Object</label> -->
                                  <!-- <input type="text" class="form-control" formControlName="endpointValue" id="renamedObject"
                                    aria-describedby="audience" placeholder="value "> -->
                                    <div class="input-group mb-3">
                                      <input type="text" class="form-control" formControlName="endpointValue" id="endpointValue"
                                    aria-describedby="audience" placeholder="value ">
                                      <button class="btn btn-primary" type="button" id="button-addonAddEndPar"
                                      (click)="addParameterAuth(i,'endpoint_params')"><svg xmlns="http://www.w3.org/2000/svg" width="16"
                                              height="16" fill="currentColor" class="bi bi-plus-lg" viewBox="0 0 16 16">
                                              <path fill-rule="evenodd"
                                                  d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2" />
                                          </svg></button>
                                  </div>
                                </div>
                  
                                <div class=" col-sm-12 mt-3 d-flex">
                                  <button *ngFor="let attr of objectMapsAuth[i] | keyvalue" class="parameter-item">
                                    {{ attr.key }} -> {{attr.value}}<mat-icon (click)="removeParameterAuth(i,attr.key ,'endpoint_params')"
                                      class="d-flex align-items-center justify-content-end">close</mat-icon>
                                  </button>
                                </div>
                              </div>
                            </div>
                            }
                            <hr class="mt-4">
                            <div class="col-sm-12 heading-with-toggle d-flex align-items-center gap-2">
                              <div>
                                <h3>Google Cloud Service Account</h3>
                              </div>
                              <div>
                                <mat-slide-toggle color="blue" formControlName="isGoogleCloudActive"></mat-slide-toggle>
                    
                              </div>
                            </div>
                            @if(!getFormGroup(i).value.isGoogleCloudActive){
                            <p>Enable a 2-legged OAuth2 flow, making the gateway request a token to an authorization server before reaching
                              the backend's protected resources. The token refreshes when needed.</p>
                            }@else{
                            <div class="col-sm-12 col-md-6">
                              <div class="mb-3">
                                <label for="audience" class="form-label">Audience <i class="bi bi-info-circle" [matTooltip]=audienceAuth_tooltip></i></label>
                                <input type="text" class="form-control" id="audience" formControlName="audience"
                                  placeholder="https://hello-there.a.run.app">
                               
                              </div>
                            </div>
                            }
                            <hr class="mt-4">
                            <div class="col-sm-12 heading-with-toggle d-flex align-items-center gap-2">
                              <div>
                                <h3>NLTM Authentication</h3>
                              </div>
                              <div>
                                <mat-slide-toggle color="blue" formControlName="isNtlmAuthActive"></mat-slide-toggle>
                              </div>
                            </div>
                            @if(!getFormGroup(i).value.isNtlmAuthActive){
                            <p>NTLM (NT Lan Manager) is a suite of Microsoft security protocols used for authentication, integrity, and
                              confidentiality of network communications. It is primarily used for authentication on Windows-based systems.
                            </p>
                            }@else{
                            <div class="col-sm-12 col-md-6">
                              <div class="mb-3">
                                <label for="user" class="form-label">User <i class="bi bi-info-circle" [matTooltip]=user_tooltip></i></label>
                                <input type="text" class="form-control" id="user" formControlName="user">
                                
                              </div>
                            </div>
                            <div class="col-sm-12 col-md-6">
                              <div class="mb-3">
                                <label for="password" class="form-label">Password <i class="bi bi-info-circle" [matTooltip]=password_tooltip></i></label>
                                <input type="password" class="form-control" id="password" formControlName="password">
                                
                              </div>
                            </div>
                            }
                            <div class="col-sm-12 d-flex justify-content-end mt-3">
                              <!-- <button mat-raised-button color="primary" (click)="saveForm()">Save</button> -->
                            </div>
                          </div>
                      </div>
                    </mat-expansion-panel>
                    <mat-expansion-panel>
                        <mat-expansion-panel-header>
                            <mat-panel-title>
                              <!-- {{ item.isNew ? 'New Panel' : 'Existing Panel' }} - {{ item.name || 'Unnamed' }} -->
                                Policies
                            </mat-panel-title>
                            <mat-panel-description>
                              <!-- ID: {{ item.id || 'Not Saved Yet' }} -->
                            </mat-panel-description>
                          </mat-expansion-panel-header>
                          <div class="section-4">
                            <div class="col-sm-12">
                                <h2>Policies</h2>
                                <h3>The policies engine lets you write custom rules validated on runtime during requests, responses,
                                  and token
                                  validation.</h3>
                              </div>
                        
                              <hr class="mt-4">
                        
                              <div class="col-sm-12">
                                <h3>Security Policies &nbsp;&nbsp;<mat-slide-toggle color="blue" formControlName="isSecPolicyActive"></mat-slide-toggle></h3>
                                <p>Implement all sorts of validations and user access control, from parameter compliance, to RBAC (Role-Based
                                  Access Control) and ABAC (Attribute-Based Access Control) strategies</p>
                                @if(getFormGroup(i).value.isSecPolicyActive){
                                <div>
                                  <h3>Request Policies</h3>
                                  <div class="d-flex">
                                    <div class="col-sm-12 col-md-6">
                                      <label for="reqp1" class="form-label">Request Policies <i class="bi bi-info-circle" [matTooltip]=reqpolicies_tooltip></i></label>
                                      <!-- <p>Request Policies</p> -->
                                      <div class="d-flex align-items-center">
                                        <!-- <input id="reqp1" type="text" class="input-size me-2 form-control"
                                          placeholder="req_params.DocId.startsWith('EU')" formControlName="securityReqPolicy">
                                        
                                        <button type="button" class="btn btn-info" (click)="addParameterPolicies(i,'securityReqPolicy')">+</button> -->
                                        <div class="input-group input-size">
                                          <input id="reqp1" type="text" class="form-control"
                                          placeholder="req_params.DocId.startsWith('EU')" formControlName="securityReqPolicy">
                                          <button class="btn btn-primary" type="button" id="button-addonSecPol"
                                          (click)="addParameterPolicies(i,'securityReqPolicy')"><svg xmlns="http://www.w3.org/2000/svg" width="16"
                                                  height="16" fill="currentColor" class="bi bi-plus-lg" viewBox="0 0 16 16">
                                                  <path fill-rule="evenodd"
                                                      d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2" />
                                              </svg></button>
                                      </div>
                                      </div>
                                      
                        
                                      <div class="mt-3 d-flex">
                                        <button *ngFor="let parameter of parameterArraySecReqPolicy[i]; let j = index" class="parameter-item">
                                          {{ parameter }}<mat-icon (click)="removeParameterPolicies(i,j,'securityReqPolicy')"
                                            class="d-flex align-items-center justify-content-end">close</mat-icon>
                                        </button>
                                      </div>
                                    </div>
                                    <div class="col-sm-12 col-md-6">
                                      <label for="errorStCode1" class="form-label">Error status code <i class="bi bi-info-circle" [matTooltip]=reqErrCode_tooltip></i></label>
                        
                                      <input id="errorStCode1" type="number" class="input-size form-control" formControlName="secReqErrorStCode"
                                        placeholder="400" />
                                      <div class="form-text"></div>
                                    </div>
                        
                                  </div>
                                </div>
                                <br>
                        
                        
                                <div>
                                  <div class="d-flex">
                                    <div class="col-sm-12 col-md-6">
                                      <!-- <p>Error body</p> -->
                                      <label for="errorBody1" class="form-label">Error body <i class="bi bi-info-circle" [matTooltip]=reqErrBody_tooltip></i></label>
                                      <input id="errorBody1" type="text" class="input-size form-control" formControlName="secReqErrorBody"
                                        placeholder="Policies violated" />
                        
                                    </div>
                                    <div class="col-sm-12 col-md-6">
                                      <label for="errorContentType1" class="form-label">Error content type <i class="bi bi-info-circle" [matTooltip]=reqContentType_tooltip></i></label>
                                      <input id="errorContentType1" type="text" class="input-size form-control"
                                        formControlName="secReqErrorContentType" placeholder="Text/Plain" />
                                      
                                    </div>
                        
                                  </div>
                                </div>
                                <br>
                                <div>
                                  <h3>Response Policies</h3>
                                  <div class="d-flex">
                                    <div class="col-sm-12 col-md-6">
                                      <label for="resP" class="form-label">Response Policies <i class="bi bi-info-circle" [matTooltip]=resPolicies_tooltip></i></label>
                                      <div class="d-flex align-items-center">
                                        <!-- <input id="resP" type="text" class="input-size me-2 form-control" formControlName="securityResPolicy"
                                          placeholder="!isEmpty(resp_data.message)">
                                        
                                        <button type="button" class="btn btn-info" (click)="addParameterPolicies(i,'securityResPolicy')">+</button> -->
                                        <div class="input-group input-size">
                                          <input id="resP" type="text" class="form-control" formControlName="securityResPolicy"
                                          placeholder="!isEmpty(resp_data.message)">
                                          <button class="btn btn-primary" type="button" id="button-addonSecResPol"
                                          (click)="addParameterPolicies(i,'securityResPolicy')"><svg xmlns="http://www.w3.org/2000/svg" width="16"
                                                  height="16" fill="currentColor" class="bi bi-plus-lg" viewBox="0 0 16 16">
                                                  <path fill-rule="evenodd"
                                                      d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2" />
                                              </svg></button>
                                      </div>
                                      </div>
                                      
                                      <div class="mt-3 d-flex">
                                        <button *ngFor="let parameter of parameterArraySecResPolicy[i]; let j = index" class="parameter-item">
                                          {{ parameter }}<mat-icon (click)="removeParameterPolicies(i,j,'securityResPolicy')"
                                            class="d-flex align-items-center justify-content-end">close</mat-icon>
                                        </button>
                                      </div>
                                    </div>
                                    <div class="col-sm-12 col-md-6">
                                      <label for="errorStCode2" class="form-label">Error status code <i class="bi bi-info-circle" [matTooltip]=resErrCode_tooltip></i></label>
                                      <input id="errorStCode2" type="number" class="input-size form-control" formControlName="secResErrorStCode"
                                        placeholder="400" />
                                      
                                    </div>
                        
                                  </div>
                                </div>
                                <br>
                        
                        
                                <div>
                                  <div class="d-flex">
                                    <div class="col-sm-12 col-md-6">
                                      <label for="errorBody2" class="form-label">Error body <i class="bi bi-info-circle" [matTooltip]=resErrBody_tooltip></i></label>
                                      <input id="errorBody2" type="text" class="input-size form-control" formControlName="secResErrorBody"
                                        placeholder="Policies violated" />
                                      
                        
                                    </div>
                                    <div class="col-sm-12 col-md-6">
                        
                                      <label for="errorContentType2" class="form-label">Error content type <i class="bi bi-info-circle" [matTooltip]=resErrContentType_tooltip></i></label>
                                      <input id="errorContentType2" type="text" class="input-size form-control"
                                        formControlName="secResErrorContentType" placeholder="Text/Plain" />
                                                              
                                    </div>
                        
                                  </div>
                                </div>
                        
                                <br>
                                <br>
                        
                                <div>
                                  <h3>Jwt validation Policeis</h3>
                                  <label for="reqp2" class="form-label">JWT Policies <i class="bi bi-info-circle" [matTooltip]=jwtPolicies_tooltip></i></label>
                                  <div class="d-flex col-sm-12 col-md-6">
                                    <!-- <input id="reqp2" type="text" class="input-size me-2 form-control"
                                      placeholder="has(JWT.user_id) && 'legal' == JWT.department" formControlName="jwtReqPolicy" />
                                    
                                    <button type="button" class="btn btn-info" (click)="addParameterPolicies(i,'jwtReqPolicy')">+</button><br> -->
                                    <div class="input-group input-size">
                                      <input id="reqp2" type="text" class="form-control"
                                      placeholder="has(JWT.user_id) && 'legal' == JWT.department" formControlName="jwtReqPolicy" />
                                      <button class="btn btn-primary" type="button" id="button-addonJwtPol"
                                      (click)="addParameterPolicies(i,'jwtReqPolicy')"><svg xmlns="http://www.w3.org/2000/svg" width="16"
                                              height="16" fill="currentColor" class="bi bi-plus-lg" viewBox="0 0 16 16">
                                              <path fill-rule="evenodd"
                                                  d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2" />
                                          </svg></button>
                                  </div>
                                  </div>
                                  
                                  <div class="mt-3 d-flex">
                                    <button *ngFor="let parameter of parameterArrayJwtValReqPolicy[i]; let j = index" class="parameter-item">
                                      {{ parameter }}<mat-icon (click)="removeParameterPolicies(i,j,'jwtReqPolicy')"
                                        class="d-flex align-items-center justify-content-end">close</mat-icon>
                                    </button>
                                  </div>
                        
                                </div>
                                <br>
                                <br>
                        
                        
                                <div>
                                  <h3>Debug and performance <i class="bi bi-info-circle" [matTooltip]=jwtDebug_tooltip></i></h3>
                                  <br>
                                  <div class="d-flex">
                                    <div class="col-sm-12 col-md-4">
                                      <div class="d-flex">
                                        <input type="checkbox" class="input-size1" formControlName="enableDebug">&nbsp;&nbsp;&nbsp;
                                        <h3 class="checkbox-text">Enable Debug</h3><br>
                                      </div>
                                      
                                    </div>
                                    <div class="col-sm-12 col-md-4">
                                      <div class="d-flex">
                                        <input type="checkbox" class="input-size1" formControlName="autoJoinPolicies">&nbsp;&nbsp;&nbsp;
                                        <h3 class="checkbox-text">Auto Join Policies <i class="bi bi-info-circle" [matTooltip]=autoJoinPolicies_tooltip></i></h3>
                                      </div>
                        
                        
                                    </div>
                                    <div class="col-sm-12 col-md-4">
                                      <div class="d-flex">
                                        <input type="checkbox" class="input-size1" formControlName="disableMacros">&nbsp;&nbsp;&nbsp;
                                        <h3 class="checkbox-text">Disable Macros <i class="bi bi-info-circle" [matTooltip]=disableMacros_tooltip></i></h3><br>
                                      </div>
                                    </div>
                        
                                  </div>
                                </div>
                        
                                }
                              </div>
                              <hr class="mt-4">
                        
                              <div class="col-sm-12">
                                <h3>Response schema validator &nbsp;&nbsp;<mat-slide-toggle color="blue"
                                    formControlName="isResSchValidatorActive"></mat-slide-toggle>
                                </h3>
                                <p>The response schema validator plugin adds a schema validation before the gateway returns the response to the
                                  end-user or before it's merged in the endpoint with the rest of the backends. </p>
                                @if(getFormGroup(i).value.isResSchValidatorActive){
                                <div class="col-sm-12 col-md-9">
                                  <textarea name="" id="" class="static-text-area" formControlName="responseSchema">{}</textarea><br>
                                  <p>Write your JSON schema directly in this field, with any number of fields or validations you need.</p>
                        
                                  <div class="d-flex col-sm-12">
                                    <div class="col-sm-12 col-md-6">
                                      <label for="errorMessage" class="form-label">Error Message <i class="bi bi-info-circle" [matTooltip]=errMessage_tooltip></i></label>
                                      <input id="errorMessage" type="text" class="input-size form-control"
                                        formControlName="resSchemaValErrorMsg" />
                                      
                                    </div>
                                    <div class="col-sm-12 col-md-6">
                                      <label for="errorStCode3" class="form-label">Error status code <i class="bi bi-info-circle" [matTooltip]=errStatusCode_tooltip></i></label>
                                      <input id="errorStCode3" type="number" class="input-size form-control"
                                        formControlName="resSchemaValErrorStCode" placeholder="500" />
                                    </div>
                        
                                  </div>
                        
                                </div>
                        
                                }
                              </div>
                          </div>
                    </mat-expansion-panel>
                    <mat-expansion-panel>
                        <mat-expansion-panel-header>
                            <mat-panel-title>
                              <!-- {{ item.isNew ? 'New Panel' : 'Existing Panel' }} - {{ item.name || 'Unnamed' }} -->
                                Connectivity
                            </mat-panel-title>
                            <mat-panel-description>
                              <!-- ID: {{ item.id || 'Not Saved Yet' }} -->
                            </mat-panel-description>
                          </mat-expansion-panel-header>
                          <div class="section-5">
                            <div class="row gap-3">
                                <h3> Interaction with services beyond regular REST. Queues, lambdas, GraphQL and other services plugged as
                                  backend servers.</h3>
                                <div class="col-sm-12 heading-with-toggle d-flex align-items-center gap-2">
                                  <div>
                                    <h3>REST to SOAP</h3>
                                  </div>
                                  <div>
                                    <mat-slide-toggle color="blue"  formControlName="isRestToSoapActive" ></mat-slide-toggle>
                                  </div>
                                </div>
                                @if(!getFormGroup(i).value.isRestToSoapActive){
                                <p>The SOAP integration crafts the body and XML content you will send to a SOAP service, injecting dynamic
                                  variables from places like the body sent by the user, headers, query strings, or parameters of the URL.
                                </p>
                                }@else{
                                  <div class="row">
                                    <div class="col-md-5 col-sm-12 form-check form-check-inline">
                                      <input class="form-check-input" type="radio" formControlName="bodyEditor" id="inlineRadio1"
                                        value="bodyeditor">
                                      <label class="form-check-label" for="inlineRadio1">Use the inline body editor</label>
                                    </div>
                            
                                    <div class="col-md-5 col-sm-12 form-check form-check-inline">
                                      <input class="form-check-input" type="radio" formControlName="bodyEditor" id="inlineRadio2" value="external">
                                      <label class="form-check-label" for="inlineRadio2">An external file</label>
                                    </div>
                                  </div>
                            
                                  <div class="col-sm-8">
                                    <label for="exampleFormControlTextarea1" class="form-label">Body Editor <i class="bi bi-info-circle" [matTooltip]=bodyEditConn_tooltip></i></label>
                                    <textarea class="form-control fingerprint" id="exampleFormControlTextarea1" rows="3"
                                      formControlName="template"></textarea>
                                    
                                  </div>
                            
                                  <div class="row">
                                    <div class="col-sm-6">
                                      <label for="conType" class="form-label">Content Type <i class="bi bi-info-circle" [matTooltip]=contentTypeConn_tooltip></i></label>
                                      <input type="text" id="conType" class="form-control" formControlName="contentType">
                                      
                                    </div>
                                    <div class="col-sm-6">
                                      <mat-checkbox class="example-margin" formControlName="debug">Enable Debug <i class="bi bi-info-circle" [matTooltip]=enableDebugConn_tooltip></i></mat-checkbox>
                                      
                                    </div>
                            
                                  </div>
                            
                                  <div class="col-sm-6">
                                    <label for="path" class="form-label">Path <i class="bi bi-info-circle" [matTooltip]=pathConn_tooltip></i></label>
                                    <input type="text" id="path" class="form-control" formControlName="path">
                                    
                                  </div>
                            
                            
                                }
                              </div>
                              
                              <hr>
                              <div class="row">
                                <div class="col-sm-12 heading-with-toggle d-flex align-items-center gap-2">
                                  <div>
                                    <h3>HTTP client settings, no redirect, and web proxy</h3>
                                  </div>
                                  <div>
                                    <mat-slide-toggle color="blue" formControlName="isHttpClientSettingActive"></mat-slide-toggle>
                                  </div>
                                </div>
                                @if(!getFormGroup(i).value.isHttpClientSettingActive){
                                <p>Configure the no-redirect behavior, or connect through an external proxy.</p>
                                }@else{
                                <div class="d-flex col-sm-12">
                                  <div class="col-sm-12 col-md-6">
                                    <label for="connectvWebProxy" class="form-label">Connect via Web Proxy <i class="bi bi-info-circle" [matTooltip]=connectWebProxy_tooltip></i></label>
                                    <input type="text" class="input-size form-control" id="connectvWebProxy"
                                      formControlName="connectvWebProxyForm">
                                  </div>
                                  <div class="col-sm-12 col-md-6">
                                    <div class="d-flex">
                                      <input type="checkbox" class="input-size1" formControlName="donotFollowRedirectsForm">&nbsp;&nbsp;&nbsp;
                                      <div class="checkbox-text">Don't follow redirects <i class="bi bi-info-circle" [matTooltip]=redirectConn_tooltip></i></div>
                                    </div>
                                    
                                  </div>
                        
                                </div>
                                }
                              </div>
                              
                              <hr>
                              <div class="row gap-3">
                                <div class="col-sm-12 heading-with-toggle d-flex align-items-center gap-2">
                                  <div>
                                    <h3>REST to GraphQL</h3>
                                  </div>
                                  <div>
                                    <mat-slide-toggle color="blue" formControlName="isRestToGraphqlActive"></mat-slide-toggle>
                                  </div>
                                </div>
                                @if(!getFormGroup(i).value.isRestToGraphqlActive){
                                <p>Translates a REST call into a GraphQL operation.</p>
                                }@else{
                        
                                <div class="d-flex col-sm-12 mb-3">
                                  <div class="col-sm-12 col-md-6">
                                    <label for="restTographQLOpType" class="form-label">Operation Type</label>
                                    <select class="form-select input-size" id="restTographQLOpType" formControlName="restTographQLOpTypeForm">
                                      <option selected></option>
                                      <option value="query" selected>query</option>
                                      <option value="mutation">mutation</option>
                                    </select>
                                    <div id="restToGraphqlOpTypeHelp" class="form-text">The type of query you are declaring.</div>
                                  </div>
                                  <div class="col-sm-12 col-md-6">
                        
                                    <label for="restTographQLOpName" class="form-label">Operation Name</label>
                                    <input type="text" class="input-size form-control" id="restTographQLOpName"
                                      formControlName="restToGraphqlOpNameForm">
                        
                                    <div id="restTographQLOpNameHelp" class="form-text">Path to the file containing the query. This file is
                                      loaded <br> during startup and never checked again, if it changes <br> KrakenD will be unaware of it.
                                    </div>
                        
                                  </div>
                        
                                </div>
                        
                                <div class="d-flex col-sm-12 mb-3">
                                  <div class="col-sm-12 col-md-6">
                                    <label for="restTographQLQueryPath" class="form-label">Query path</label>
                                    <input type="text" class="input-size form-control" id="restTographQLQueryPath"
                                      formControlName="restTographQLQueryPathForm">
                                    <div id="restTographQLQueryPathHelp" class="form-text"></div>
                                  </div>
                                  <div class="col-sm-12 col-md-6">
                        
                                    <label for="restTographQLInlineQuery" class="form-label">... or Inline Query</label>
                                    <input type="text" class="input-size form-control" id="restTographQLInlineQuery"
                                      formControlName="restTographQLInlineQueryForm">
                                    <div id="restTographQLInlineQueryhelp" class="form-text">An inline GraphQL query you want to send to the
                                      server. <br> Use this attribute for simple and inline queries, use <br> query_path instead for larger
                                      queries. Use escaping when <br> needed.</div>
                        
                                  </div>
                        
                                </div>
                        
                                <div class="row align-items-end mb-3">
                        
                                  <div class="col-sm-12 col-md-4">
                                    <label for="restTographQLVariable" class="form-label">Variable</label>
                                    <input type="text" class="input-size form-control" id="restTographQLVariable"
                                      formControlName="restTographQLVariable">
                                  </div>
                                  <div class="col-sm-12 col-md-4">
                        
                                    <label for="restTographQLValue" class="form-label">Value</label>
                                    <!-- <input type="text" class="input-size form-control me-4" id="restTographQLValue"
                                      formControlName="restTographQLValue"> -->
                                      <div class="input-group">
                                        <input type="text" class="form-control" id="restTographQLValue"
                                      formControlName="restTographQLValue">
                                        <button class="btn btn-primary" type="button" id="button-addonRestToGrQl"
                                        (click)="addParameterConnect(i,'restToGraphQLMap')"><svg xmlns="http://www.w3.org/2000/svg" width="16"
                                                height="16" fill="currentColor" class="bi bi-plus-lg" viewBox="0 0 16 16">
                                                <path fill-rule="evenodd"
                                                    d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2" />
                                            </svg> Add Variable</button>
                                    </div>
                                  </div>
                        
                                 
                        
                                </div>
                                <div *ngFor="let attr of objectMapsConnectRestToGraph[i] | keyvalue" class="row mb-3 d-flex align-items-center">
                                  <div class="col-sm-12 col-md-4">
                                    {{attr.key}}
                                  </div>
                                  <div class="col-sm-12 col-md-4">
                                    {{attr.value}}
                                  </div>
                                  <div class="col-sm-12 col-md-4">
                                    <button type="button" class="btn btn-dark delete-btn"
                                      (click)="removeParameterConnect(i,attr.key ,'restToGraphQLMap')"><b>X</b></button>
                                  </div>
                                </div>
                                <div id="restTographQLValueHelp" class="col-sm-12 form-text">A dictionary defining all the variables sent to the
                                  GraphQL
                                  server. You can use &#123;placeholders&#125; to inject parameters from the endpoint URL. In the example
                                  above, the
                                  GraphQL server receives a variable user with the &#123;user_id&#125; declared in the endpoint. The
                                  dictionary can have
                                  any nesting level you need, but nested variables cannot contain &#123;placeholders&#125;.</div>
                        
                                }
                              </div>
                              
                              <hr>
                              <div class="row gap-3">
                                <div class="col-sm-12 heading-with-toggle d-flex align-items-center gap-2">
                                  <div>
                                    <h3>AMQP consumer</h3>
                                  </div>
                                  <div>
                                    <mat-slide-toggle color="blue" formControlName="isAMQPconsumerActive"></mat-slide-toggle>
                                  </div>
                                </div>
                                @if(!getFormGroup(i).value.isAMQPconsumerActive){
                                <p>Enables consumption of messages using the Advanced Message Queuing Protocol in servers such as RabbitMQ</p>
                                }@else{
                                <div class="d-flex col-sm-12 mb-3">
                                  <div class="col-sm-12 col-md-4">
                        
                                    <label for="amqpConsumerQueueName" class="form-label">Queue Name</label>
                                    <input type="text" class="input-size form-control" id="amqpConsumerQueueName"
                                      formControlName="amqpConsumerQueueNameForm">
                        
                                    <div id="amqpConsumerQueueNameHelp" class="form-text">The name of the queue you want to <br> connect to
                                    </div>
                        
                                  </div>
                                  <div class="col-sm-12 col-md-4">
                        
                                    <label for="amqpConsumerExchange" class="form-label">Exchange</label>
                                    <input type="text" class="input-size form-control" id="amqpConsumerExchange"
                                      formControlName="amqpConsumerExchangeForm">
                        
                                    <div id="amqpConsumerExchangeHelp" class="form-text">The entity name where messages are <br> sent for
                                      routing
                                    </div>
                        
                                  </div>
                                  <div class="col-sm-12 col-md-4">
                                    <label for="amqpConsumerBackOffStratgy" class="form-label">Operation Type</label>
                                    <select class="form-select input-size" id="amqpConsumerBackOffStratgy"
                                      formControlName="amqpConsumerBackOffStratgyForm">
                                      <option selected>query</option>
                                      <option value="query">Linear - Delay time between attemps grows linearly</option>
                                      <option value="mutation">Linear Jitter - Linear plus r  random</option>
                                      <option value="mutation">Exponential - 2s, 4s, 8s, 16s...</option>
                                      <option value="mutation">Exponential Jitter - Exponential  random</option>
                                      <option value="mutation">Fallback - Retry every 1 second</option>
                        
                                    </select>
                                    <div id="restToGraphqlOpTypeHelp" class="form-text">The type of query you are declaring.</div>
                                  </div>
                                </div>
                                <div class="d-flex col-sm-12 mb-3">
                                  <div class="col-sm-12 col-md-6">
                                    <label for="amqpConsumerRoutingKeys" class="form-label">Routing Keys</label>
                                    <div class="d-flex">
                                      <div class="input-group input-size">
                                        <input type="text" class="form-control" id="amqpConsumerRoutingKeys"
                                        formControlName="amqpConsumerRoutingKeysForm">
                                        <button class="btn btn-primary" type="button" id="button-addonRoutKey"
                                        (click)="addParameterConnect(i,'amqpConsumerRoutingKeysForm')"><svg xmlns="http://www.w3.org/2000/svg" width="16"
                                                height="16" fill="currentColor" class="bi bi-plus-lg" viewBox="0 0 16 16">
                                                <path fill-rule="evenodd"
                                                    d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2" />
                                            </svg></button>
                                    </div>
                                      <!-- <input type="text" class="input-size me-2 form-control" id="amqpConsumerRoutingKeys"
                                        formControlName="amqpConsumerRoutingKeysForm">
                                      <button type="button" class="btn btn-info"
                                        (click)="addParameterConnect(i,'amqpConsumerRoutingKeysForm')">+</button> -->
                                    </div>
                                    <div id="amqpConsumerRoutingKeysHelp" class="form-text">List of all the routing keys or pattern to bind the
                                      queue to <br> the exchange
                                    </div>
                                    <div class="mt-3 d-flex">
                                      <button *ngFor="let attr of amqpRoutingKeysArray[i]; let j = index" class="parameter-item">
                                        {{ attr }}<mat-icon (click)="removeParameterConnect(i,j,'amqpConsumerRoutingKeysForm')"
                                          class="d-flex align-items-center justify-content-end">close</mat-icon>
                                      </button>
                                    </div>
                        
                                  </div>
                                  <div class="col-sm-12 col-md-6">
                                    <label for="amqpConsumerPrefetchCnt" class="form-label">Prefetch Count</label>
                                    <div class="d-flex">
                                      <input type="number" class="input-size2 form-control" id="amqpConsumerPrefetchCnt"
                                        formControlName="amqpConsumerPrefetchCntForm">
                                      <button class="fixed-button">msgs</button>
                                    </div>
                                    <div id="amqpConsumerPrefetchCntHelp" class="form-text">Specifies a prefetch window in terms of whole
                                      messages
                                    </div>
                        
                                  </div>
                        
                        
                                </div>
                                <div class="d-flex col-sm-12">
                                  <div class="col-sm-12 col-md-6">
                                    <div class="d-flex">
                                      <input type="checkbox" class="input-size1" formControlName="amqpConsumerDurableForm">&nbsp;&nbsp;&nbsp;
                                      <div class="checkbox-text">Durable</div>
                                    </div>
                                    <div class="form-text">Durable exchanges survive broker restart (persist to disk) <br> whereas transient
                                      exchanges do not</div>
                        
                                  </div>
                                  <div class="col-sm-12 col-md-6">
                                    <div class="d-flex">
                                      <input type="checkbox" class="input-size1" formControlName="amqpConsumerNoLocalForm">&nbsp;&nbsp;&nbsp;
                                      <div class="checkbox-text">No-local</div>
                                    </div>
                                    <div class="form-text">The server will not send messages to the connection that <br> published them.</div>
                        
                                  </div>
                        
                                </div>
                        
                                }
                              </div>
                              
                              <hr>
                              <div class="row gap-3">
                                <div class="col-sm-12 heading-with-toggle d-flex align-items-center gap-2">
                                  <div>
                                    <h3>AWS Lambda</h3>
                                  </div>
                                  <div>
                                    <mat-slide-toggle color="blue" formControlName="isAWSlambdaActive"></mat-slide-toggle>
                                  </div>
                                </div>
                                @if(!getFormGroup(i).value.isAWSlambdaActive){
                                <p>Calls a Lambda function in AWS as its backend.</p>
                                }@else{
                                <div class="col-sm-12 d-flex mb-3">
                                  <div class="col-sm-12 col-md-6">
                                    <label for="awsLambdaFunctionName" class="form-label">Function name</label>
                                    <input type="text" class="input-size form-control" id="awsLambdaFunctionName"
                                      formControlName="awsLambdaFunctionNameForm">
                                    <div id="awsLambdaFunctionNameHelp" class="form-text">Name of the lambda function as saved in the AWS
                                      service. <br> Leave EMPTY if taken from a parameter.</div>
                                  </div>
                                  <div class="col-sm-12 col-md-6">
                                    <label for="awsLambdaFunctionParamName" class="form-label">Function param name</label>
                                    <input type="text" class="input-size form-control" id="awsLambdaFunctionParamName"
                                      formControlName="awsLambdaFunctionParamNameForm">
                                    <div id="awsLambdaFunctionParamNameHelp" class="form-text">When the lambda function name comes in a
                                      &#123;placeholder&#125; <br> inside the endpoint.</div>
                                  </div>
                        
                                </div>
                                <div class="col-sm-12 d-flex mb-3">
                                  <div class="col-sm-12 col-md-6">
                                    <label for="awsLambdaRegion" class="form-label">Region</label>
                                    <input type="text" class="input-size form-control" id="awsLambdaRegion"
                                      formControlName="awsLambdaRegionForm">
                                    <div id="awsLambdaRegionHelp" class="form-text">The AWS identifier region (e.g.: us-east-1, eu-west-2, etc.
                                      )</div>
                                  </div>
                                  <div class="col-sm-12 col-md-6">
                                    <label for="awsLambdaMaxRetries" class="form-label">Max retries</label>
                                    <div class="d-flex">
                                      <input type="number" class="input-size2 form-control" id="awsLambdaMaxRetries"
                                        formControlName="awsLambdaMaxRetriesForm">
                                      <button class="fixed-button">retries</button>
                                    </div>
                                    <div id="awsLambdaMaxRetriesHelp" class="form-text">Maximum times you want to execute the function until you
                                      <br> have a successful response.
                                    </div>
                                  </div>
                        
                        
                                </div>
                        
                                <div class="col-sm-12">
                                  <label for="awsLambdaEndpoint" class="form-label">Endpoint</label>
                                  <input type="text" class="input-size form-control" id="awsLambdaEndpoint"
                                    formControlName="awsLambdaEndpointForm">
                                  <div id="awsLambdaEndpointHelp" class="form-text">An optional parameter to customize the Lambda endpoint to
                                    call. Useful when Localstack is used for testing.</div>
                        
                                </div>
                                }
                              </div>
                              
                              <hr>
                              <div class="row gap-3">
                                <div class="col-sm-12 heading-with-toggle d-flex align-items-center gap-2">
                                  <div>
                                    <h3>REST to gRPC</h3>
                                  </div>
                                  <div>
                                    <mat-slide-toggle color="blue" formControlName="isrestToGRPCActive"></mat-slide-toggle>
                                  </div>
                                </div>
                                @if(!getFormGroup(i).value.isrestToGRPCActive){
                                <p>This backend is a gRPC server and will connect to a service defined in the <span class="text-edit1">gRPC
                                    catalog</span></p>
                                }@else{
                                <p>Set in the URL of this backend the full name of the gRPC service and method call, for instance <span
                                    class="text-edit">/flight_finder.Flights/FindFlight</span>. The service must be declared in the <span
                                    class="text-edit1">gRPC catalog</span>
                                </p>
                                <div class="col-sm-12 d-flex mb-3">
                                  <div class="col-sm-12 col-md-6">
                                    <label for="restTogrpcReqNamingConvention" class="form-label">Request naming convention</label>
                                    <select id="restTogrpcReqNamingConvention" class="form-select input-size"
                                      formControlName="restTogrpcReqNamingConventionForm">
                                      <option selected></option>
                                      <option value="snake_case">snake_case</option>
                                      <option value="camelCase">camelCase</option>
                                    </select>
                                    <div id="restTogrpcReqNamingConventionHelp" class="form-text">Defines the naming convention used to format
                                      the data.</div>
                        
                                  </div>
                                  <div class="col-sm-12 col-md-6">
                                    <label for="restTogrpcResNamingConvention" class="form-label">Response naming convention</label>
                                    <select id="restTogrpcResNamingConvention" class="form-select input-size"
                                      formControlName="restTogrpcResNamingConventionForm">
                                      <option selected></option>
                                      <option value="snake_case">snake_case</option>
                                      <option value="camelCase">camelCase</option>
                                    </select>
                                    <div id="restTogrpcResNamingConventionHelp" class="form-text">Defines the naming convention used to format
                                      the data.</div>
                        
                                  </div>
                        
                                </div>
                                <div class="col-sm-12 d-flex mb-3">
                                  <div class="col-sm-12 col-md-6">
                                    <div class="d-flex">
                                      <input type="checkbox" class="input-size1" formControlName="restTogrpcUseReqBodyForm">&nbsp;&nbsp;&nbsp;
                                      <div class="checkbox-text">Use request body</div>
                                    </div>
                                    <div class="form-text" id="restTogrpcUseReqBodyHelp">Enables the use of the sent body to fill the gRPC
                                      request.</div>
                                  </div>
                                  <div class="col-sm-12 col-md-6">
                                    <div class="d-flex">
                                      <input type="checkbox" class="input-size1"
                                        formControlName="restTogrpcAllowInsecureConForm">&nbsp;&nbsp;&nbsp;
                                      <div class="checkbox-text">Allow insecure connections</div>
                                    </div>
                                    <div class="form-text" id="restTogrpcAllowInsecureConHelp">Allow untrusted certificates in development
                                      stage.</div>
                                  </div>
                        
                                </div>
                                <div class="col-sm-12 d-flex mb-3">
                                  <div class="col-sm-12 col-md-6">
                                    <div class="d-flex">
                                      <input type="checkbox" class="input-size1"
                                        formControlName="restTogrpcRemoveUnsetValForm">&nbsp;&nbsp;&nbsp;
                                      <div class="checkbox-text">Remove unset values</div>
                                    </div>
                                    <div class="form-text" id="restTogrpcRemoveUnsetValHelp">When the response has missing fields from the
                                      definition,<br> they are returned with default values. Setting this flag to <br> true removes those fields
                                      from the response, while setting <br> it to false or not setting it, returns all the fields in the <br>
                                      definition.</div>
                                  </div>
                                  <div class="col-sm-12 col-md-6">
                                    <div class="d-flex">
                                      <input type="checkbox" class="input-size1" formControlName="restTogrpcEnumsAsStrgsForm">&nbsp;&nbsp;&nbsp;
                                      <div class="checkbox-text">Enums as Strings</div>
                                    </div>
                                    <div class="form-text" id="restTogrpcEnumsAsStrgsHelp">Enum types are returned as numeric values (flag set
                                      to <br> false). Set this flag to true to return the string <br> representation of the enum value. For
                                      instance, an enum <br> representing allergies, such as ['NUTS', 'MILK', ' SOY', <br> 'WHEAT'] would return
                                      a value SOY when this flag is true,<br> or 2 when false.</div>
                                  </div>
                        
                                </div>
                                <div class="col-sm-12 d-flex mb-3">
                                  <div class="col-sm-12 col-md-6">
                                    <div class="d-flex">
                                      <input type="checkbox" class="input-size1"
                                        formControlName="restTogrpcTimestmpAsStrgsForm">&nbsp;&nbsp;&nbsp;
                                      <div class="checkbox-text">Timestamp as strings</div>
                                    </div>
                                    <div class="form-text" id="restTogrpcTimestmpAsStrgsHelp">Well-known Timestamp types <br> (<span
                                        class="text-edit">google.protobuf.Timestamp</span>) are returned as a struct <br> containing fields with
                                      seconds and nanos fields (flag set to <br> false). Setting this flag to true transforms the timestamps
                                      <br> into a string representation in RFC3999 format.
                                    </div>
                                  </div>
                                  <div class="col-sm-12 col-md-6">
                                    <div class="d-flex">
                                      <input type="checkbox" class="input-size1"
                                        formControlName="restTogrpcDurationAsStrgsForm">&nbsp;&nbsp;&nbsp;
                                      <div class="checkbox-text"> Duration as strings</div>
                                    </div>
                                    <div class="form-text" id="restTogrpcDurationAsStrgsHelp">Well-known Duration types
                                      (google.protobuf.Duration) are <br> returned as a struct containing fields with seconds and <br> nanos
                                      fields (flag set to false). Setting this flag to true <br> transforms the timestamps into a string
                                      representation in <br> seconds.</div>
                                  </div>
                        
                                </div>
                                <div class="col-sm-12 mb-3">
                                  <div class="d-flex">
                                    <input type="checkbox" class="input-size1" formControlName="restTogrpcDisableQueryParamForm">
                                    <div class="checkbox-text">Disable query parameters</div>
                                  </div>
                                  <div class="form-text" id="restTogrpcDisableQueryParamHelp">When checked it does not use URL parameters or
                                    query strings to fill the gRPC payload to send. If you don't set request <br> body, there will be no input
                                    used for the gRPC message (it's fine if you want an <span class="text-edit1">empty message</span>)</div>
                        
                                </div>
                                <div class="row align-items-end mb-3">
                                  <h3 class="checkbox-text mb-3">Input Mapping</h3>
                                  <div class="col-sm-12 col-md-4">
                                    <label for="restTogprcInputMappingField">Field</label>
                                    <input type="text" class="form-control input-size mt-2" id="restTogprcInputMappingField"
                                      formControlName="restTogprcInputMappingFieldForm">
                                  </div>
                                  <div class="col-sm-12 col-md-4">
                                    <label for="restTogprcInputMappingMapAs">Map as</label>
                                    <input type="text" class="form-control input-size mt-2" id="restTogprcInputMappingMapAs"
                                      formControlName="restTogprcInputMappingMapAsForm">
                                  </div>
                                  <div class="col-sm-12 col-md-4">
                                    <button type="button" class="btn btn-primary" (click)="addParameterConnect(i,'inputMappingFieldAndMapAs')"><b>+</b> Add
                                      mapping</button>
                                  </div>
                                </div>
                                <div *ngFor="let attr of objectMapsConnect[i] | keyvalue" class="row mb-3 d-flex align-items-center">
                                  <div class="col-sm-12 col-md-4">
                                    {{attr.key}}
                                  </div>
                                  <div class="col-sm-12 col-md-4">
                                    {{attr.value}}
                                  </div>
                                  <div class="col-sm-12 col-md-4">
                                    <button type="button" class="btn btn-dark delete-btn"
                                      (click)="removeParameterConnect(i,attr.key ,'restToGraphQLMap')"><b>X</b></button>
                                  </div>
                                </div>
                                <div id="restTogprcInputMappingHelp" class="form-text">A dictionary that converts the user input into a
                                  different field during the backend request.</div>
                                }
                              </div>
                              
                              <hr>
                              <div class="row gap-3">
                                <div class="col-sm-12 heading-with-toggle d-flex align-items-center gap-2">
                                  <div>
                                    <h3>Pub/Sub: Subscriber</h3>
                                  </div>
                                  <div>
                                    <mat-slide-toggle color="blue" formControlName="isPublicSubscriberActive"></mat-slide-toggle>
                                  </div>
                                </div>
                                @if(!getFormGroup(i).value.isPublicSubscriberActive){
                                <p>Read events from a queue</p>
                                }@else{
                                <div class="col-sm-12 mb-3">
                                  <label for="publicSubSubscriptionType">Subscription type</label>
                                  <!-- <input type="text" class="form-control input-size" id="publicSubSubscriptionType" formControlName="publicSubSubscriptionTypeForm"> -->
                                  <select name="" id="publicSubSubscriptionType" class="form-select input-size"
                                    formControlName="publicSubSubscriptionTypeForm">
                                    <option value="GCP PubSub
                                      ">GCP PubSub
                                    </option>
                                    <option value="NATS
                                      ">NATS
                                    </option>
                                    <option value="AWS SNS
                                      ">AWS SNS
                                    </option>
                                    <option value="AWS SQS
                                      ">AWS SQS
                                    </option>
                                    <option value="Azure Service Bus Topic and Subscription
                                      ">Azure Service Bus Topic and Subscription
                                    </option>
                                    <option value="RabbitMQ
                                      ">RabbitMQ
                                    </option>
                                    <option value="Kafka
                                      ">Kafka
                                    </option>
                                  </select>
                                  <div id="publicSubSubscriptionTypeHelp" class="form-text">Click on a subscription_url type to load an example
                                    URL.</div>
                        
                                </div>
                                <div class="col-sm-12 mb-3">
                                  <label for="publicSubSubscriptionURL">Subscription URL</label>
                                  <input type="text" id="publicSubSubscriptionURL" class="form-control input-size"
                                    formControlName="publicSubSubscriptionURLForm">
                                  <div class="form-text">The subscription URL. See <span class="text-edit1">the pub/sub documentation</span> for
                                    all supported protocols</div>
                        
                                </div>
                        
                                }
                              </div>
                              
                              <hr>
                              <div class="row gap-3">
                                <div class="col-sm-12 heading-with-toggle d-flex align-items-center gap-2">
                                  <div>
                                    <h3>Pub/Sub: Publisher</h3>
                                  </div>
                                  <div>
                                    <mat-slide-toggle color="blue" formControlName="isPublicPublisherActive"></mat-slide-toggle>
                                  </div>
                                </div>
                                @if(!getFormGroup(i).value.isPublicPublisherActive){
                                <p>Pushes events to a queue</p>
                                }@else{
                                <div class="col-sm-12 mb-3">
                                  <label for="publicPubSubscriptionType">Subscription type</label>
                                  <!-- <input type="text" class="form-control input-size" id="publicSubSubscriptionType" formControlName="publicSubSubscriptionTypeForm"> -->
                                  <select name="" id="publicPubSubscriptionType" class="form-select input-size"
                                    formControlName="publicPubSubscriptionTypeForm">
                                    <option value="GCP PubSub
                                        ">GCP PubSub
                                    </option>
                                    <option value="NATS
                                        ">NATS
                                    </option>
                                    <option value="AWS SNS
                                        ">AWS SNS
                                    </option>
                                    <option value="AWS SQS
                                        ">AWS SQS
                                    </option>
                                    <option value="Azure Service Bus Topic and Subscription
                                        ">Azure Service Bus Topic and Subscription
                                    </option>
                                    <option value="RabbitMQ
                                        ">RabbitMQ
                                    </option>
                                    <option value="Kafka
                                        ">Kafka
                                    </option>
                                  </select>
                                  <div id="publicPubSubscriptionTypeHelp" class="form-text">Click on a subscription_url type to load an example
                                    URL.</div>
                        
                                </div>
                                <div class="col-sm-12 mb-3">
                                  <label for="publicPubSubscriptionURL">Topic URL</label>
                                  <input type="text" id="publicPubTopicURL" class="form-control input-size"
                                    formControlName="publicPubTopicURLForm">
                                  <div class="form-text">The subscription URL. See <span class="text-edit1">the pub/sub documentation</span> for
                                    all supported protocols</div>
                        
                                </div>
                        
                                }
                              </div>
                              
                              <hr>
                              <div class="row gap-3">
                                <div class="col-sm-12 heading-with-toggle d-flex align-items-center gap-2">
                                  <div>
                                    <h3> AMQP producer</h3>
                                  </div>
                                  <div>
                                    <mat-slide-toggle color="blue"  formControlName="isAMQPproducerActive"></mat-slide-toggle>
                                  </div>
                                </div>
                                @if(!getFormGroup(i).value.isAMQPproducerActive){
                                <p>Pushes events to a queue</p>
                                }@else{
                                <div class="col-sm-12 d-flex mb-3">
                                  <div class="col-sm-12 col-md-6">
                                    <label for="amqpProducerQueueName">Queue name</label>
                                    <input type="text" id="amqpProducerQueueName" class="form-control input-size"
                                      formControlName="amqpProducerQueueNameForm">
                                    <div class="form-text" id="amqpProducerQueueNameHelp">The name of the queue you want to connect to</div>
                                  </div>
                                  <div class="col-sm-12 col-md-6">
                                    <label for="amqpProducerExchange">Exchange</label>
                                    <input type="text" id="amqpProducerExchange" class="form-control input-size"
                                      formControlName="amqpProducerExchangeForm">
                                    <div class="form-text" id="amqpProducerExchangeHelp">The entity name where messages are sent for routing
                                    </div>
                                  </div>
                                </div>
                                <div class="col-sm-12 d-flex mb-3">
                                  <div class="col-sm-12 col-md-6">
                                    <label for="amqpProducerBackoffStrategy">Backoff Strategy</label>
                                    <select class="form-select input-size" id="amqpProducerBackoffStrategy"
                                      formControlName="amqpProducerBackoffStrategyForm">
                                      <option value="Linear - Delay time between attemps grows linearly">Linear - Delay time between attemps
                                        grows linearly</option>
                                      <option value="Linear Jitter - Linear plus r  random">Linear Jitter - Linear plus r  random</option>
                                      <option value="Exponential - 2s, 4s, 8s, 16s...">Exponential - 2s, 4s, 8s, 16s...</option>
                                      <option value="Exponential Jitter - Exponential  random">Exponential Jitter - Exponential  random
                                      </option>
                                      <option value="Fallback - Retry every 1 second">Fallback - Retry every 1 second</option>
                                    </select>
                                    <div class="form-text" id="amqpProducerQueueNameHelp">When the connection to your event source gets
                                      interrupted <br> for whatever reason, KrakenD keeps trying to reconnect <br> after a delay</div>
                                  </div>
                                  <div class="col-sm-12 col-md-6">
                                    <div class="d-flex">
                                      <input type="checkbox" class="input-size1" formControlName="amqpProducerDurableForm">&nbsp;&nbsp;&nbsp;
                                      <div class="checkbox-text">Durable</div>
                                    </div>
                                    <div class="form-text" id="amqpProducerDurableHelp">Durable exchanges survive broker restart whereas <br>
                                      transient exchanges do not</div>
                                  </div>
                                </div>
                        
                                }
                              </div>
                          </div>
                    </mat-expansion-panel>
                    
            </mat-accordion>
            
            <!-- <mat-accordion>
              
                </mat-accordion> -->
          </form>
        <!-- Buttons -->
        <div class="d-flex justify-content-end gap-2 mt-3">
          <button
            mat-raised-button
            color="primary"
            *ngIf="item.isNew"
            (click)="saveBackend(i)"
          >
            Save
          </button>
          <button
            mat-raised-button
            color="accent"
            *ngIf="!item.isNew"
            (click)="updateBackend(i,item.id)"
          >
            Update
          </button>
        </div>
      </mat-expansion-panel>
    </mat-accordion>
  <!-- <div class="row mt-3">
    <div class="col-sm-12">
        <button mat-raised-button color="primary" (click)="addPanel()">Add Backend</button>
    </div>
  </div> -->
    
  </div>
  